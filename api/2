//Importar los paquetes necesarios para app.mjs
import express from 'express'
import connect from './db/dbconnection.mjs'
import { menuCLI } from './utils/menuCLI.mjs';
import router from './routes/crudRoutes.mjs';

//Usamos express para iniciar el API
const app = express();
const port = process.env.PORT || 3000 //establecemos nuestro puerto
const ip = process.env.IP || '0.0.0.0'; //establecemos nuestra ip

app.use((req, res, next) => {
    req.db = db;
    next();
});

app.use('/api', router);
app.set('json spaces', 2);

app.listen(port, ip, () => console.log('escuchando el puerto ', port, ' y la ip ', ip));

//conectamos con la base de datos
const db = await connect();

//iniciamos men√∫CLI
await menuCLI(db);
